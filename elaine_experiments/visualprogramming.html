<html>
<head>
<style>
body {
	background: #2b2b2b;
	color: white;
	font-family: Georgia;
	font-style: italic;
	margin-top: 100px;
	margin-left: 200px;
}
</style>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js" type="text/javascript"></script>
<script type="text/javascript">

var selectElem_player = "<select>" +
						"<option>[select player]</option>" + 
						"<option>current player</option>" +
						"<option>all players</option>" +
						"<option>no players</option>" +
						"</select>";
var selectElem_slot = "<select>" +
						"<option>[select slot]</option>" + 
						"<option>this slot</option>" +
						"<option>all slots</option>" +
						"<option>no slots</option>" +
						"</select>";
var selectElem_piece = "<select>" +
						"<option>[select piece]</option>" + 
						"<option>piece to move</option>" +
						"<option>all pieces</option>" +
						"<option>no pieces</option>" +
						"</select>";
var selectElem_locationAndType = "<select id='locationAndType'>" +
						"<option></option>" + 
						"<option>is on board</option>" +
						"<option>is not on board</option>" +
						"<option value='ofType'>is of type ... </option>" +
						"<option value='notOfType'>is not of type ... </option>" +
						"</select>";
						
var selectElem_pieceType = "<select id='pieceType'>" +
						"<option>[select piece (TODO: get user's pieces)]</option>" + 
						"<option>piece type A</option>" +
						"<option>piece type B</option>" +
						"<option>piece type C</option>" +
						"</select>";
						
var selectElem_change = "<select id='do_action_change'>" +
						"<option>[select what to change]</option>" + 
						"<option>piece</option>" +
						"<option>player</option>" +
						"<option value='spaces'>number spaces to move</option>" +
						"<option value='path'>path to go</option>" +
						"</select>";
						
var selectElem_add = "<select id='do_action_add'>" +
						"<option>[select what to add]</option>" + 
						"<option>piece</option>" +
						"<option>slot</option>" +
						"</select>";	
						
var selectElem_perm = "<select>" +
						"<option>[select permanence]</option>" + 
						"<option>permanently</option>" +
						"<option>non-permanently</option>" +
						"</select>";							

var selectElem_do_rules = "<select>" +
						"<option></option>" + 
						"<option>slot</option>" +
						"<option>number of turns</option>" +
						"</select>";

var selectElem_do_turns = selectElem_player + "<span>" +
						"<input type='text' placeholder='number of turns' />" +
						"</span>";
						
$(document).ready(function() {
	// user selects the object that will do the sensing
	$("#sensing_object").change(
		function () {
			$( this ).nextAll().remove();
			$( this ).parent().remove('span')
			var val = $( this ).val();
			var next = "";
			if (val == "player") { 
				next = selectElem_player + "<span>has</span> " + selectElem_piece;
			} else if (val == "slot") {
				next = selectElem_slot + "<span>has</span> " + selectElem_piece;
			} else if (val == "piece") {
				next = selectElem_piece + selectElem_locationAndType;
			}
			$( this ).parent().append(next);
			initializeSelectMenus();			
			
		}
	);
	
	$("#action").change(
		function () {
			$( this ).nextAll().remove();
			$( this ).parent().remove('span')
			var val = $( this ).val();
			var next = "";
			if (val == "change") next = selectElem_change;
			else if (val == "add") next = selectElem_add;
			else if (val == "remove") next = selectElem_piece + selectElem_perm;
			else if ((val == "disable_leave") || (val == "disable_land") || (val == "enable_leave") || (val == "enable_land")) next = selectElem_do_rules;
			else if ((val == "give") || (val == "skip")) next = selectElem_do_turns;
			else if ((val == "win") || (val == "lose")) next = selectElem_player;
			$( this ).parent().append(next);
			initializeSelectMenus();
		}
	);
	
	function initializeSelectMenus() {
	
		// select menu for piece being of a certain type
		$("#locationAndType").change(
			function () {
				var val = $( this ).val();
				if ((val == "ofType") || (val == "notOfType")) {
					if ($('#pieceType').length == 0) {
						$( this ).parent().append(selectElem_pieceType);
					}
				} else {
					$( this ).nextAll().remove();				
				}
			}
		);
		
		$("#do_action_change").change(
			function () {
				$( this ).nextAll().remove();
				$( this ).parent().remove('span')
				var val = $( this ).val();
				var next = "";
				if (val == "piece") { 
					next = selectElem_piece;
				} else if (val == "player") {
					next = selectElem_player;
				} else if (val == "spaces") {
					next += "<input type='text' placeholder='num turns' />";
				} else if (val == "path") {
					next += "<input type='text' placeholder='path' />";
				}
				$( this ).parent().append(next);
			}
		);
		
		$("#do_action_add").change(
			function () {
				$( this ).nextAll().remove();
				var val = $( this ).val();
				var next = "";
				if (val == "piece") { 
					next = selectElem_piece;
				} else if (val == "slot") {
					next = selectElem_slot;
				} 
				$( this ).parent().append(next);
			}
		);
	}
});
</script>
</head>
<body>

<div id="e" class="rule">
	<div class="when">
		<h2>When:</h2>
		<select id="sensing_object">
			<option></option>
			<option>player</option>
			<option>slot</option>
			<option>piece</option>
		</select>
		&raquo;
	</div>
	<div class="do">
		<h2>Do:</h2>
		<select id="action">
			<option></option>
			<option value="change">change</option>
			<option value="add">add to board ... </option>
			<option value="remove">remove piece from board</option>
			<option value="disable_leave">disable leave rules</option>
			<option value="disable_land">disable land rules</option>
			<option value="enable_leave">enable leave rules</option>
			<option value="enable_land">enable land rules</option>
			<option value="give">give player more turns </option>
			<option value="skip">player skips turn</option>
			<option value="win">player wins</option>
			<option value="lose">player loses</option>
			<option value="end">end game</option>
		</select>
	</div>
</div>

</body>
</html>